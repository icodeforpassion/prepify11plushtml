<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex, nofollow" />
  <title>Life in the UK – Secret Practice Quiz</title>
  <style>
    :root {
      --bg: #f5f7fb;
      --card-bg: #ffffff;
      --primary: #4f46e5;
      --border: #d0d4e4;
      --option-bg: #f7f8ff;
      --option-hover: #e6e9ff;
      --correct-bg: #d2f5dd;
      --correct-border: #65c27c;
      --incorrect-bg: #fbd5d5;
      --incorrect-border: #e55353;
      --text: #111827;
      --muted: #6b7280;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 24px;
    }

    .container {
      width: 100%;
      max-width: 700px;
    }

    .card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    }

    h1 {
      margin: 0 0 8px;
      font-size: 24px;
      text-align: center;
    }

    .subtext {
      margin: 0 0 20px;
      color: var(--muted);
      text-align: center;
    }

    .hidden {
      display: none;
    }

    .unlock-form {
      display: grid;
      gap: 12px;
    }

    input[type="password"] {
      padding: 12px;
      border-radius: 8px;
      border: 1px solid var(--border);
      font-size: 16px;
      width: 100%;
    }

    button {
      cursor: pointer;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      padding: 12px 14px;
      transition: background 0.15s ease, transform 0.1s ease;
    }

    button.primary {
      background: var(--primary);
      color: #ffffff;
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    button:not(:disabled):active {
      transform: translateY(1px);
    }

    .error {
      color: var(--incorrect-border);
      min-height: 20px;
      text-align: center;
      font-size: 14px;
    }

    .status-message {
      text-align: center;
      color: var(--correct-border);
      margin-top: 4px;
    }

    .quiz-body {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .category {
      color: var(--muted);
      font-weight: 600;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .question {
      font-size: 18px;
      font-weight: 600;
      margin: 4px 0 8px;
    }

    .options {
      display: grid;
      gap: 10px;
    }

    .option-btn {
      width: 100%;
      text-align: left;
      background: var(--option-bg);
      border: 1px solid var(--border);
      color: var(--text);
    }

    .option-btn:hover:not(:disabled) {
      background: var(--option-hover);
    }

    .option-btn.correct {
      background: var(--correct-bg);
      border-color: var(--correct-border);
    }

    .option-btn.incorrect {
      background: var(--incorrect-bg);
      border-color: var(--incorrect-border);
    }

    .bottom-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .score {
      font-weight: 600;
      color: var(--text);
    }

    .final {
      text-align: center;
      display: grid;
      gap: 12px;
    }

    @media (max-width: 480px) {
      .card {
        padding: 18px;
      }
      .question {
        font-size: 17px;
      }
      .bottom-bar {
        flex-direction: column;
        align-items: stretch;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>Life in the UK – Secret Practice Quiz</h1>
      <p class="subtext" id="subtext">Private access only.</p>

      <div id="unlock-section" class="unlock-form">
        <p class="subtext" style="margin-top: 0;">Enter secret code to unlock the quiz.</p>
        <input type="password" id="secret-input" aria-label="Secret code" placeholder="Enter code" />
        <button class="primary" id="unlock-btn">Unlock</button>
        <div class="error" id="error-msg"></div>
        <div class="status-message hidden" id="access-msg">Access granted.</div>
      </div>

      <div id="quiz-section" class="quiz-body hidden">
        <div id="question-meta">
          <div class="category" id="category"></div>
          <div class="question" id="question"></div>
        </div>
        <div class="options" id="options"></div>
        <div class="bottom-bar">
          <div class="score" id="score">Score: 0</div>
          <button class="primary" id="next-btn" disabled>Next Question</button>
        </div>
        <div class="final hidden" id="final-screen">
          <h2>Quiz Completed</h2>
          <p id="final-score"></p>
          <button class="primary" id="restart-btn">Restart Quiz</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function () {
      const SECRET_CODE = "LIFEUK-ACCESS-500";
      const unlockSection = document.getElementById("unlock-section");
      const quizSection = document.getElementById("quiz-section");
      const errorMsg = document.getElementById("error-msg");
      const accessMsg = document.getElementById("access-msg");
      const secretInput = document.getElementById("secret-input");
      const unlockBtn = document.getElementById("unlock-btn");
      const categoryEl = document.getElementById("category");
      const questionEl = document.getElementById("question");
      const optionsEl = document.getElementById("options");
      const scoreEl = document.getElementById("score");
      const nextBtn = document.getElementById("next-btn");
      const finalScreen = document.getElementById("final-screen");
      const finalScoreEl = document.getElementById("final-score");
      const restartBtn = document.getElementById("restart-btn");

      let questions = [];
      let currentIndex = 0;
      let score = 0;
      let answered = false;

      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      function resetQuizState() {
        currentIndex = 0;
        score = 0;
        answered = false;
        scoreEl.textContent = `Score: ${score}`;
        nextBtn.disabled = true;
        finalScreen.classList.add("hidden");
      }

      function renderQuestion() {
        if (!questions.length) return;
        const item = questions[currentIndex];
        categoryEl.textContent = item.category || "";
        questionEl.textContent = item.question || "";
        optionsEl.innerHTML = "";
        answered = false;
        nextBtn.disabled = true;

        item.options.forEach((opt, idx) => {
          const btn = document.createElement("button");
          btn.className = "option-btn";
          btn.textContent = opt;
          btn.dataset.index = idx;
          btn.addEventListener("click", () => handleAnswer(btn, idx, item.answer));
          optionsEl.appendChild(btn);
        });
      }

      function handleAnswer(button, selectedIndex, correctIndex) {
        if (answered) return;
        answered = true;
        const optionButtons = Array.from(optionsEl.querySelectorAll(".option-btn"));
        optionButtons.forEach((btn, idx) => {
          btn.disabled = true;
          if (idx === correctIndex) {
            btn.classList.add("correct");
          }
          if (idx === selectedIndex && idx !== correctIndex) {
            btn.classList.add("incorrect");
          }
        });
        if (selectedIndex === correctIndex) {
          score += 1;
          scoreEl.textContent = `Score: ${score}`;
        }
        nextBtn.disabled = false;
      }

      function showFinalScreen() {
        finalScoreEl.textContent = `Your Score: ${score} out of ${questions.length}`;
        finalScreen.classList.remove("hidden");
        document.getElementById("question-meta").classList.add("hidden");
        optionsEl.classList.add("hidden");
        nextBtn.classList.add("hidden");
      }

      function nextQuestion() {
        if (!answered) return;
        if (currentIndex < questions.length - 1) {
          currentIndex += 1;
          renderQuestion();
        } else {
          showFinalScreen();
        }
      }

      function restartQuiz() {
        questions = shuffle(questions);
        resetQuizState();
        document.getElementById("question-meta").classList.remove("hidden");
        optionsEl.classList.remove("hidden");
        nextBtn.classList.remove("hidden");
        renderQuestion();
      }

      async function loadQuestions() {
        try {
          const res = await fetch("/data/lifeinukquestions.json");
          if (!res.ok) throw new Error("Failed to load questions");
          const data = await res.json();
          questions = shuffle(data.slice());
          resetQuizState();
          renderQuestion();
        } catch (error) {
          errorMsg.textContent = "Unable to load quiz questions.";
          console.error(error);
        }
      }

      function unlockQuiz() {
        const value = secretInput.value.trim();
        if (value === SECRET_CODE) {
          errorMsg.textContent = "";
          accessMsg.classList.remove("hidden");
          unlockSection.classList.add("hidden");
          quizSection.classList.remove("hidden");
          loadQuestions();
        } else {
          errorMsg.textContent = "Incorrect code. Try again.";
          accessMsg.classList.add("hidden");
        }
      }

      unlockBtn.addEventListener("click", unlockQuiz);
      secretInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          unlockQuiz();
        }
      });

      nextBtn.addEventListener("click", nextQuestion);
      restartBtn.addEventListener("click", restartQuiz);
    })();
  </script>
</body>
</html>
