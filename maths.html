<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prepify11Plus Maths Missions</title>
  <meta name="description" content="Colourful 11+ maths practice covering arithmetic, fractions, geometry, triangle logic, reasoning, and measurement.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/site.css">
</head>
<body>
  <header>
    <div class="navbar">
      <div class="brand">
        <div class="brand-logo">P</div>
        <h1>Prepify11Plus</h1>
      </div>
      <div class="nav-group">
        <nav class="nav-links" aria-label="Primary">
          <a href="index.html">Home</a>
          <a href="flashcards.html">Flashcards</a>
          <a href="maths.html" aria-current="page">Maths Practice</a>
          <a href="mock.html">Mock Tests</a>
          <a href="about.html">About</a>
        </nav>
        <label class="theme-picker">
          <span>Theme</span>
          <select data-theme-select aria-label="Choose a superhero theme">
            <option value="superman">Superman</option>
            <option value="spiderman">Spiderman</option>
            <option value="captain">Captain America</option>
            <option value="batman">Batman</option>
            <option value="ironman">Iron Man</option>
            <option value="hulk">Hulk</option>
            <option value="thor">Thor</option>
            <option value="blackpanther">Black Panther</option>
            <option value="wonderwoman">Wonder Woman</option>
            <option value="flash">Flash</option>
          </select>
        </label>
      </div>
    </div>
  </header>

  <main>
    <section class="page-heading">
      <div>
        <h2>Maths skill builders for fearless thinkers</h2>
        <p class="tagline">Pick a category, tackle superhero missions, and level up with immediate feedback. All questions live in JSON files so new challenges can be added whenever you like.</p>
      </div>
      <div class="badge">
        <span>📊</span>
        <span>6 categories • 70+ starter questions</span>
      </div>
    </section>

    <section class="section">
      <div class="card-grid" id="categoryGrid"></div>

      <div class="question-area" id="questionArea" hidden>
        <div class="timed-banner">
          <strong id="activeCategoryLabel">Category</strong>
          <span>Score: <span id="scoreDisplay">0</span></span>
          <span>Questions answered: <span id="answeredDisplay">0</span></span>
        </div>
        <article class="question-card">
          <h3 id="questionText">Choose a category to begin.</h3>
          <div class="question-options" id="optionList"></div>
          <button class="btn btn-primary" id="nextQuestion" disabled>Next question</button>
          <p id="questionFeedback" role="alert"></p>
        </article>
        <div class="super-meter">
          <span id="mathsProgress" style="width:0%"></span>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="footer-inner">
      <p>© <span id="currentYear"></span> Prepify11Plus.</p>
      <div class="counter">
        <span>👀 Visitors so far:</span>
        <span id="countValue">40,000+</span>
      </div>
    </div>
  </footer>

  <script src="assets/theme.js" defer></script>
  <script src="assets/counter.js" defer></script>
  <script>
    const categoryConfig = [
      {
        id: 'arithmetic',
        title: 'Arithmetic',
        icon: '➗',
        description: 'Mental maths drills covering addition, subtraction, multiplication, and division.',
        file: '/data/arithmetic_questions.json'
      },
      {
        id: 'fractions',
        title: 'Fractions & Decimals',
        icon: '🟰',
        description: 'Convert, compare, and simplify with visual-friendly fraction scenarios.',
        file: '/data/fractions_questions.json'
      },
      {
        id: 'geometry',
        title: 'Geometry',
        icon: '📐',
        description: 'Explore perimeter, area, angles, and shapes you meet in the 11+. ',
        file: '/data/geometry_questions.json'
      },
      {
        id: 'triangles',
        title: 'Triangle Logic',
        icon: '🔺',
        description: 'Classify triangles, spot patterns, and reason about missing angles.',
        file: '/data/triangle_logic_questions.json'
      },
      {
        id: 'reasoning',
        title: 'Reasoning & Patterns',
        icon: '🧠',
        description: 'Number sequences, codes, and shape patterns built to stretch thinking.',
        file: '/data/reasoning_questions.json'
      },
      {
        id: 'measurement',
        title: 'Measurement & Units',
        icon: '📏',
        description: 'Conversions, time problems, and comparisons to keep practice practical.',
        file: '/data/measurement_questions.json'
      }
    ];

    const mathsState = {
      activeCategory: null,
      questions: [],
      currentIndex: 0,
      score: 0,
      answered: 0
    };

    function buildCategoryCards() {
      const grid = document.getElementById('categoryGrid');
      categoryConfig.forEach(category => {
        const card = document.createElement('article');
        card.className = 'info-card';
        card.innerHTML = `
          <div class="feature-icon" aria-hidden="true">${category.icon}</div>
          <div>
            <h3>${category.title}</h3>
            <p>${category.description}</p>
          </div>
          <button class="btn btn-primary" data-category="${category.id}">Start mission</button>
        `;
        grid.appendChild(card);
      });
    }

    function loadCategory(categoryId) {
      const config = categoryConfig.find(cat => cat.id === categoryId);
      if (!config) return;
      document.getElementById('questionArea').hidden = false;
      document.getElementById('activeCategoryLabel').textContent = `${config.title} mission`;
      document.getElementById('questionText').textContent = 'Loading questions…';
      document.getElementById('optionList').innerHTML = '';
      document.getElementById('questionFeedback').textContent = '';
      mathsState.currentIndex = 0;
      mathsState.score = 0;
      mathsState.answered = 0;
      updateScoreboard();
      fetch(config.file)
        .then(res => res.json())
        .then(data => {
          mathsState.activeCategory = config;
          mathsState.questions = data.sort(() => Math.random() - 0.5);
          if (!mathsState.questions.length) {
            document.getElementById('questionText').textContent = 'No questions available yet. Add some to the JSON file!';
            return;
          }
          displayQuestion();
        })
        .catch(() => {
          document.getElementById('questionText').textContent = 'Unable to load questions. Check the JSON file path.';
        });
    }

    function displayQuestion() {
      const question = mathsState.questions[mathsState.currentIndex];
      if (!question) return;
      document.getElementById('questionText').textContent = question.question;
      const optionList = document.getElementById('optionList');
      optionList.innerHTML = '';
      const shuffled = [...question.options].sort(() => Math.random() - 0.5);
      shuffled.forEach(option => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'option-btn';
        btn.textContent = option;
        btn.addEventListener('click', () => handleAnswer(option === question.answer, btn, question));
        optionList.appendChild(btn);
      });
      document.getElementById('nextQuestion').disabled = true;
      document.getElementById('questionFeedback').textContent = '';
      updateProgressBar();
    }

    function handleAnswer(isCorrect, button, question) {
      const optionButtons = document.querySelectorAll('.option-btn');
      optionButtons.forEach(btn => btn.disabled = true);
      mathsState.answered += 1;
      if (isCorrect) {
        button.classList.add('correct');
        mathsState.score += 1;
        document.getElementById('questionFeedback').textContent = question.explanation || 'Correct! Keep it up.';
      } else {
        button.classList.add('incorrect');
        document.getElementById('questionFeedback').textContent = `Not quite. The correct answer is ${question.answer}. ${question.explanation || ''}`.trim();
        optionButtons.forEach(btn => {
          if (btn.textContent === question.answer) {
            btn.classList.add('correct');
          }
        });
      }
      document.getElementById('nextQuestion').disabled = false;
      updateScoreboard();
      updateProgressBar();
    }

    function nextQuestion() {
      if (!mathsState.questions.length) return;
      mathsState.currentIndex = (mathsState.currentIndex + 1) % mathsState.questions.length;
      displayQuestion();
    }

    function updateScoreboard() {
      document.getElementById('scoreDisplay').textContent = mathsState.score;
      document.getElementById('answeredDisplay').textContent = mathsState.answered;
    }

    function updateProgressBar() {
      const total = mathsState.questions.length || 1;
      const progress = Math.min(100, Math.round((mathsState.answered / total) * 100));
      document.getElementById('mathsProgress').style.width = `${progress}%`;
    }

    document.addEventListener('DOMContentLoaded', () => {
      buildCategoryCards();
      document.getElementById('currentYear').textContent = new Date().getFullYear();
      document.getElementById('categoryGrid').addEventListener('click', event => {
        const button = event.target.closest('button[data-category]');
        if (!button) return;
        loadCategory(button.dataset.category);
      });
      document.getElementById('nextQuestion').addEventListener('click', nextQuestion);
    });
  </script>
</body>
</html>
