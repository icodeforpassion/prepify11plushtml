<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Prepify11Plus Vocabulary Flashcards</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="assets/site.css" />

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      background: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      transition: background 0.3s, color 0.3s;
    }

    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem 1rem;
      text-align: center;
    }

    h1.gradient {
      background: var(--gradient-text);
      -webkit-background-clip: text;
      color: transparent;
      margin-bottom: 0.5rem;
    }

    p.intro {
      color: var(--text-light);
      margin-bottom: 1.5rem;
      max-width: 600px;
      line-height: 1.4;
    }

    .flashcard {
      background: var(--card-front);
      color: #fff;
      border-radius: 18px;
      box-shadow: var(--shadow-m);
      padding: 2rem;
      text-align: center;
      width: 90%;
      max-width: 400px;
      transition: transform 0.5s;
      cursor: pointer;
      position: relative;
      min-height: 220px;
    }

    .flashcard.flipped {
      transform: rotateY(180deg);
      background: var(--card-back);
      color: var(--text);
    }

    .input-area {
      margin-top: 1rem;
      text-align: center;
      width: 100%;
      max-width: 400px;
    }

    input[type="text"] {
      width: 100%;
      padding: 0.7rem;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--bg-alt);
      color: var(--text);
      font-size: 1rem;
      outline: none;
      transition: box-shadow 0.2s;
    }

    input[type="text"]:focus {
      box-shadow: var(--focus-ring);
    }

    .actions {
      margin-top: 1.1rem;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 0.6rem;
    }

    button {
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 0.6rem 1rem;
      font-weight: 500;
      cursor: pointer;
      box-shadow: var(--shadow-xs);
      transition: background 0.2s;
    }

    button:hover {
      background: var(--primary-hover);
    }

    .feedback {
      margin-top: 0.9rem;
      font-weight: 600;
      min-height: 1.5rem;
    }

    .feedback.positive {
      color: var(--success);
    }

    .feedback.negative {
      color: var(--danger);
    }

    footer {
      background: var(--bg-alt);
      border-top: 1px solid var(--border);
      text-align: center;
      padding: 1rem;
      font-size: 0.9rem;
      color: var(--text-light);
    }

    .example {
      font-size: 0.9rem;
      opacity: 0.8;
      margin-top: 0.5rem;
    }

    @media (max-width: 600px) {
      .flashcard {
        padding: 1.4rem;
      }
    }
  </style>
</head>

<body>
  <header>
    <div class="navbar">
      <div class="brand">
        <div class="brand-logo">P</div>
        <h1>Prepify11Plus</h1>
      </div>
      <div class="nav-group">
        <nav class="nav-links" aria-label="Primary">
          <a href="index.html">Home</a>
          <a href="flashcards.html" aria-current="page">Flashcards</a>
          <a href="maths.html">Maths Practice</a>
          <a href="mock.html">Mock Tests</a>
          <a href="about.html">About</a>
        </nav>
        <label class="theme-picker">
          <span>Theme</span>
          <select data-theme-select aria-label="Choose a superhero theme">
            <option value="superman">Superman</option>
            <option value="spiderman">Spiderman</option>
            <option value="captain">Captain America</option>
            <option value="batman">Batman</option>
            <option value="ironman">Iron Man</option>
            <option value="hulk">Hulk</option>
            <option value="thor">Thor</option>
            <option value="blackpanther">Black Panther</option>
            <option value="wonderwoman">Wonder Woman</option>
            <option value="flash">Flash</option>
          </select>
        </label>
      </div>
    </div>
  </header>

  <main>
    <h1 class="gradient">Vocabulary Flashcards</h1>
    <p class="intro">Boost your vocabulary the smart way! Flip each card to reveal meanings and examples, or test yourself by typing answers.</p>

    <div id="flashcard" class="flashcard" tabindex="0">
      <div id="questionWord">Loading‚Ä¶</div>
      <div id="meaningText" style="display:none;"></div>
      <div id="exampleText" class="example" style="display:none;"></div>
    </div>

    <div class="input-area" id="inputArea">
      <input type="text" id="userAnswer" placeholder="Type the meaning here..." />
      <div class="actions">
        <button id="btnCheck">Check</button>
        <button id="btnReveal">Flip</button>
        <button id="btnNext">Next</button>
      </div>
    </div>

    <p id="feedback" class="feedback"></p>

    <div class="actions">
      <button id="btnShuffle">Shuffle Deck</button>
      <button id="btnResetStats">Reset Stats</button>
    </div>
  </main>

  <footer>
    <p>¬© <span id="currentYear"></span> Prepify11Plus | Keep building your word power ‚ú®</p>
  </footer>

  <script src="assets/theme.js" defer></script>

  <script>
    let words = [];
    let current = null;
    let stats = { answered: 0, correct: 0 };

    const els = {
      flashcard: document.getElementById('flashcard'),
      questionWord: document.getElementById('questionWord'),
      meaningText: document.getElementById('meaningText'),
      exampleText: document.getElementById('exampleText'),
      userAnswer: document.getElementById('userAnswer'),
      btnCheck: document.getElementById('btnCheck'),
      btnReveal: document.getElementById('btnReveal'),
      btnNext: document.getElementById('btnNext'),
      feedback: document.getElementById('feedback'),
      btnShuffle: document.getElementById('btnShuffle'),
      btnResetStats: document.getElementById('btnResetStats')
    };

    function parseLines(raw) {
      return raw.split(/\r?\n/)
        .map(line => line.trim())
        .filter(Boolean)
        .map(line => {
          let parts = line.split('‚Äì');
          if (parts.length < 2) parts = line.split(' - ');
          const [rawWord, rawMeaning, rawExample] = [
            parts[0] || '',
            parts[1] || '',
            parts.slice(2).join('‚Äì')
          ];
          return {
            word: rawWord.replace(/^\d+\.\s*/, '').trim(),
            meaning: (rawMeaning || '').trim(),
            example: (rawExample || '').trim()
          };
        })
        .filter(entry => entry.word);
    }

    function loadDefaultVocabulary() {
      fetch('/data/sample_vocabulary.txt')
        .then(r => r.text())
        .then(data => {
          words = parseLines(data);
          if (!words.length) throw new Error('No valid words found');
          shuffle(words);
          nextWord();
        })
        .catch(err => console.error('Error loading vocabulary:', err));
    }

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    function nextWord() {
      if (!words.length) return;
      current = words[Math.floor(Math.random() * words.length)];
      els.questionWord.textContent = current.word;
      els.meaningText.textContent = current.meaning;
      els.exampleText.textContent = current.example ? "Example: " + current.example : '';
      els.meaningText.style.display = "none";
      els.exampleText.style.display = "none";
      els.flashcard.classList.remove('flipped');
      els.feedback.textContent = '';
      els.userAnswer.value = '';
    }

    function flipCard() {
      const isFlipped = els.flashcard.classList.toggle('flipped');
      els.meaningText.style.display = isFlipped ? "block" : "none";
      els.exampleText.style.display = isFlipped ? "block" : "none";
    }

    function checkAnswer() {
      if (!current) return;
      const user = els.userAnswer.value.trim().toLowerCase();
      const correct = current.meaning.toLowerCase();
      const sim = similarity(user, correct);
      stats.answered++;
      if (sim >= 0.7) {
        stats.correct++;
        els.feedback.textContent = "‚úÖ Correct!";
        els.feedback.className = "feedback positive";
      } else {
        els.feedback.textContent = "‚ùå Not quite. It means: " + current.meaning;
        els.feedback.className = "feedback negative";
      }
    }

    function similarity(a, b) {
      const dist = levenshtein(a, b);
      return 1 - dist / Math.max(a.length, b.length);
    }

    function levenshtein(a, b) {
      const matrix = [];
      let i, j;
      for (i = 0; i <= b.length; i++) matrix[i] = [i];
      for (j = 0; j <= a.length; j++) matrix[0][j] = j;
      for (i = 1; i <= b.length; i++) {
        for (j = 1; j <= a.length; j++) {
          if (b.charAt(i - 1) === a.charAt(j - 1)) {
            matrix[i][j] = matrix[i - 1][j - 1];
          } else {
            matrix[i][j] = Math.min(
              matrix[i - 1][j - 1] + 1,
              Math.min(matrix[i][j - 1] + 1, matrix[i - 1][j] + 1)
            );
          }
        }
      }
      return matrix[b.length][a.length];
    }

    function resetStats() {
      stats = { answered: 0, correct: 0 };
      els.feedback.textContent = "üîÑ Stats reset!";
      els.feedback.className = "feedback";
    }

    // Event listeners
    els.flashcard.addEventListener('click', flipCard);
    els.btnCheck.addEventListener('click', checkAnswer);
    els.btnReveal.addEventListener('click', flipCard);
    els.btnNext.addEventListener('click', nextWord);
    els.btnShuffle.addEventListener('click', () => { shuffle(words); nextWord(); });
    els.btnResetStats.addEventListener('click', resetStats);
    els.userAnswer.addEventListener('keydown', e => { if (e.key === 'Enter') checkAnswer(); });

    document.getElementById('currentYear').textContent = new Date().getFullYear();
    loadDefaultVocabulary();
  </script>
</body>
</html>
